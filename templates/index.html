{% extends "base.html" %}
{% block title %}{{ text.title }}{% endblock %}

{% block head %}
<style>
    .hero { text-align: center; padding: 60px 20px; border-bottom: 2px dashed var(--ink); margin-bottom: 40px; }
/* templates/base.html */
    .grid { 
        display: grid; 
        /* Change 320px to 280px to fit mobile screens better */
        grid-template-columns: repeat(auto-fill, minmax(280px, 1fr)); 
        gap: 20px; 
        padding: 0 15px; /* Add padding so cards don't touch edge */
        max-width: 1200px; 
        margin: 0 auto; 
    }
    .avatar { width: 70px; height: 70px; border-radius: 50%; border: 3px solid var(--ink); object-fit: cover; filter: sepia(0.2); }
    
    /* PROGRESS BAR & ICONS */
    .progress-container { 
        width: 100%; 
        height: 24px; /* Made slightly taller for the icon */
        border: 2px solid var(--ink); 
        background: #eee; 
        border-radius: 12px; 
        overflow: hidden; 
        margin: 10px 0; 
        position: relative; /* Needed for icon positioning */
    }
    
    .progress-fill { 
        height: 100%; 
        background: repeating-linear-gradient(45deg, var(--purple), var(--purple) 10px, #7b3eb0 10px, #7b3eb0 20px); 
        transition: width 1s; 
        border-right: 2px solid var(--ink);
    }
    .progress-fill.gold { background: repeating-linear-gradient(45deg, var(--gold), var(--gold) 10px, #b08d1e 10px, #b08d1e 20px); }
    
    /* THE GOAL ICON (Shirt/Crown) */
    .goal-icon {
        position: absolute;
        right: 8px;
        top: 50%;
        transform: translateY(-50%);
        font-size: 1rem;
        z-index: 5;
        opacity: 0.8;
        filter: drop-shadow(1px 1px 0px rgba(0,0,0,0.2));
    }
    
    .stamp { position: absolute; top: 10px; right: 10px; border: 3px solid var(--green); color: var(--green); padding: 5px; font-weight: bold; transform: rotate(-15deg); font-size: 0.8rem; background: white; z-index: 10; font-family: 'Noto Sans Thai', sans-serif;}
</style>
{% endblock %}

{% block content %}
<div class="hero">
    <h1 style="font-family:'Limelight', 'Noto Sans Thai'; font-size: 3.5rem; margin:0; color: var(--purple);">{{ text.hero_title }}</h1>
    <div style="font-weight:bold; border-top:2px solid var(--ink); border-bottom:2px solid var(--ink); display:inline-block; padding:5px 20px; margin-top:10px;">
        {{ text.hero_badge }}
    </div>
</div>

<div class="grid">
    {% for member in members %}
    <div class="card">
        {% if member.total_distance >= 50 %}<div class="stamp">{{ text.stamp_qual }}</div>{% endif %}
        
        <div style="display:flex; align-items:center; gap:15px; margin-bottom:15px; border-bottom:2px dashed #eee; padding-bottom:15px;">
            <img src="{{ member.profile }}" class="avatar" loading="lazy">
            <div>
                <div style="font-family:'Limelight', 'Noto Sans Thai'; font-size:1.4rem; line-height:1;">{{ member.firstname }}</div>
                <div style="font-size:0.7rem; font-weight:bold; letter-spacing:1px; color: {% if member.total_distance >= 100 %}var(--gold){% elif member.total_distance >= 50 %}var(--green){% else %}#888{% endif %};">
                    {% if member.total_distance >= 100 %}{{ text.rank_elite }}{% elif member.total_distance >= 50 %}{{ text.rank_member }}{% else %}{{ text.rank_rookie }}{% endif %}
                </div>
            </div>
        </div>

        <div style="display:flex; justify-content:space-between; font-weight:bold; font-size:0.9rem;">
            <span>{{ text.dist_month }}</span>
            <span>{{ member.total_distance }} KM</span>
        </div>

        <div class="progress-container">
            <div class="goal-icon">
                {% if member.total_distance < 50 %}ðŸ‘•{% else %}ðŸ‘‘{% endif %}
            </div>

            {% if member.total_distance < 50 %}
                <div class="progress-fill" style="width: {{ (member.total_distance / 50) * 100 }}%"></div>
            {% else %}
                <div class="progress-fill gold" style="width: {{ ((member.total_distance - 50) / 50) * 100 if member.total_distance < 100 else 100 }}%"></div>
            {% endif %}
        </div>
        
        <div style="text-align:center; font-size:0.6rem; opacity:0.6; text-transform:uppercase;">
            {% if member.total_distance < 50 %}{{ text.goal_shirt }}{% else %}{{ text.goal_elite }}{% endif %}
        </div>
    </div>
    {% else %}
    <div style="grid-column: 1 / -1; text-align: center; padding: 40px;">
        <p>{{ text.empty_db }}</p>
    </div>
    {% endfor %}
</div>
{% endblock %}