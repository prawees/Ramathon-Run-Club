{% extends "base.html" %}
{% block title %}{{ text.profile_file }}{% endblock %}

{% block content %}
<div style="max-width: 600px; margin: 40px auto; padding: 0 20px;">
    <h1 style="font-family: 'Limelight', 'Noto Sans Thai'; text-align: center; font-size: 2.5rem; color: var(--purple);">{{ text.profile_file }}</h1>
    
    <div class="card" style="text-align: center; position: relative; margin-top: 20px;">
        {% if user.total_distance >= 50 %}
            <div style="position: absolute; top: 10px; right: 10px; border: 3px solid var(--green); color: var(--green); padding: 5px; font-weight: bold; transform: rotate(-15deg); font-family: 'Noto Sans Thai';">{{ text.stamp_qual }}</div>
        {% endif %}

        <img src="{{ user.profile }}" style="width:120px; height:120px; border-radius:50%; border:3px solid var(--ink); margin-bottom:15px; filter: sepia(0.3);">
        
        <h2 style="font-family:'Limelight', 'Noto Sans Thai'; margin:0; text-transform: uppercase;">
            {{ user.firstname }} {{ user.lastname }}
        </h2>
        
        <p style="font-weight:bold; color: {% if user.total_distance >= 100 %}var(--gold){% elif user.total_distance >= 50 %}var(--green){% else %}var(--purple){% endif %};">
            {% if user.total_distance >= 100 %}{{ text.rank_elite }}
            {% elif user.total_distance >= 50 %}{{ text.rank_member }}
            {% else %}{{ text.rank_rookie }}{% endif %}
        </p>
        
        <hr style="border:none; border-top:2px dashed var(--ink); margin:20px 0;">
        
        <div style="text-align: left; margin-bottom: 20px;">
            <div style="font-size: 0.8rem; font-weight: bold; margin-bottom: 5px;">PROGRESS</div>
            <div style="width: 100%; height: 24px; border: 2px solid var(--ink); background: #eee; border-radius: 12px; overflow: hidden; position: relative;">
                
                <div style="position: absolute; right: 10px; top: 50%; transform: translateY(-50%); z-index: 5;">
                    {% if user.total_distance < 50 %}ðŸ‘•{% else %}ðŸ‘‘{% endif %}
                </div>

                {% if user.total_distance < 50 %}
                    <div style="height: 100%; background: repeating-linear-gradient(45deg, var(--purple), var(--purple) 10px, #7b3eb0 10px, #7b3eb0 20px); border-right: 2px solid var(--ink); width: {{ (user.total_distance / 50) * 100 }}%"></div>
                {% else %}
                    <div style="height: 100%; background: repeating-linear-gradient(45deg, var(--gold), var(--gold) 10px, #b08d1e 10px, #b08d1e 20px); border-right: 2px solid var(--ink); width: {{ ((user.total_distance - 50) / 50) * 100 if user.total_distance < 100 else 100 }}%"></div>
                {% endif %}
            </div>
        </div>

        <div style="display:flex; justify-content:space-around; margin-bottom:20px;">
            <div>
                <small style="display:block; letter-spacing:1px;">{{ text.dist_month }}</small>
                <div style="font-size:1.8rem; font-weight:bold;">{{ user.total_distance }} KM</div>
            </div>
            <div>
                <small style="display:block; letter-spacing:1px;">STATUS</small>
                <div style="font-size:1.8rem; font-weight:bold; color: {% if user.total_distance >= 50 %}var(--green){% else %}var(--purple){% endif %}; font-family: 'Noto Sans Thai';">
                    {% if user.total_distance >= 50 %}{{ text.status_claim }}{% else %}{{ text.status_locked }}{% endif %}
                </div>
            </div>
        </div>
        
        {% if user.total_distance < 50 %}
            <p style="font-size:0.9rem; font-style:italic; background: rgba(157, 78, 221, 0.1); padding: 15px; border-radius: 8px;">
                "{{ text.msg_close }} <strong>{{ (50 - user.total_distance)|round(1) }}</strong> {{ text.msg_km_away }}"
            </p>
        {% else %}
            <p style="font-size:0.9rem; font-style:italic; background: rgba(46, 125, 50, 0.1); padding: 15px; border-radius: 8px;">
                "{{ text.msg_win }}"
            </p>
        {% endif %}
        
        <a href="{{ url_for('update_stats') }}" style="display:inline-block; margin-top:20px; color:var(--ink); font-size:0.8rem;">
            {{ text.btn_sync }}
        </a>
    </div>
</div>
{% endblock %}